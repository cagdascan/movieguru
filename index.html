<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black" />
        <title>Movie Guru</title>
        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.css" />
        <link rel="stylesheet" href="my.css" />
        <script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
        <script src="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.js"></script>
        
        <script>
		try {

			$(function() {

			});

			} catch (error) {
			console.error("Your javascript has an error: " + error);
		}
        </script>

        <script>//local database script
			//OPEN AND OR CREATE THE DATABASE ON THE USERS MACHINE
			var db = openDatabase("myMovies", "1", "My Watch List", 100000);
			var movies = [];
			var movie_wish_list = [];
			var i = 1;
		  
			function storeMyMovie(id) {
				var i = localStorage.length + 1;
				movies[i]	= id.innerHTML;
				localStorage.setItem('movie'+i, movies[i]);	
				//console.log(localStorage.length);				
			}
			


			//GET STORED VALUES FROM KEYS TO DEFINE JAVASCRIPT VALUES 
			function getMyAllMovies() {
		  	  	for ( var i = 1; i <= localStorage.length; i++ ) { 
		  	  		movie_wish_list[i] = localStorage.getItem('movie'+i);
		      		$('.movie_wish_list').append('<li><a href="#"><img src="logo.png"><h2>'+movie_wish_list[i]+'</h2><p>'+movie_wish_list[i]+'</p></a><a href="#delete" data-rel="popup" data-position-to="window" data-transition="pop">Purchase album</a></li>');
				}
			  }

			function getMyMovie() {
		  	  	
		  	  		movie_wish_list[localStorage.length] = localStorage.getItem('movie'+localStorage.length);
		      		$('.movie_wish_list').append('<li id ='+ i +'"><a href="#"><img src="logo.png"><h2>'+movie_wish_list[localStorage.length]+'</h2><p>'+movie_wish_list[localStorage.length]+'</p></a><a href="#delete" data-rel="popup" data-position-to="window" data-transition="pop">Purchase album</a></li>');
				
			  }
			  function removeMyMovie() {
				//var id = id;// movies[i]	= id.innerHTML;
				
				localStorage.removeItem('movie1');
				getMyAllMovies();
				location.reload();

				//sadece ilk filmi siliyor -- istedigin filmi silecek sekilde yap!!!!
				//console.log(id);			
			}

			function clearLocal() {
			    clear: localStorage.clear(); 
			    return false;
			  }			
		</script><!--local database end-->



		<script>
			$('#mgogo').live('click',function() //generate my pleasure buttonu
			{
				var secilenler = $('.secimler').serialize().toString();
				console.log(secilenler);//for debugging
				$.mobile.showPageLoadingMsg("b", "Loading", false); //loading spinner
				$.getJSON("http://bayez.biz/moviegurus/?rating=7.0&rating=10.0&year=2000&" + $('.secimler').serialize(),
					function (data) 
					{
						var titles = [];
						var years = [];
						var ratings = [];
						var arkas = [];
						var posters = [];
						var plots = [];
						var result_title = function(i){
							return "#result"+i+"_title";
						};
						var result_rating = function(i){
							return "#result"+i+"_rating";
						};
						var result_year = function(i){
							return "#result"+i+"_year";
						};
						var result_arka = function(i){
							return "#result"+i+"_arka";
						};
						var result_poster = function(i){
							return ".result"+i+"_poster";
						};
						var result_plot = function(i){
							return "#result"+i+"_plot";
						};
						
						$.each(data, function(i,item)
						{
							titles.push(item.title);
							years.push(item.year);
							ratings.push("<p>" + item.rating + "</p>");
							arkas.push("<img src='" + item.poster + "' />");
							posters.push("<img style='display:block;width:100%;height:auto;' src='" + item.poster + "' />");
							plots.push(item.plot_simple);
							$(result_title(i)).append (titles[i]);
							$(result_rating(i)).append (ratings[i]);
						    $(result_year(i)).append (years[i]);
							$(result_arka(i)).append (arkas[i]);
							$(result_poster(i)).append (posters[i]);
							$(result_plot(i)).append (plots[i]);
					  	});
					  $.mobile.changePage('#result0');
					});
			}); 
			
		//	$('#result0').live('click',function(){ //iphone icin click yerine 'swipeleft' 'swiperightkullan'
        //		$.mobile.changePage('#result1');
        //	});
        //	$('#result1').live('click',function(){ //iphone icin click yerine 'swipeleft' 'swiperightkullan'
        //		$.mobile.changePage('#result2');
        //	}); 
        //	$('#result2').live('click',function(){ //iphone icin click yerine 'swipeleft' 'swiperightkullan'
        //		$.mobile.changePage('#result3');
        //	}); 
        //	$('#result3').live('click',function(){ //iphone icin click yerine 'swipeleft' 'swiperightkullan'
        //		$.mobile.changePage('#result4');
        //	}); 
        //	$('#result4').live('click',function(){ //iphone icin click yerine 'swipeleft' 'swiperightkullan'
        //		$.mobile.changePage('#result0');
        //	});   
		</script>
    </head>
    <body>
        <div data-role="page" id="page1"> <!--Page 1 - Genre secim sayfasi -->
            <div data-role="header" data-position="fixed" data-id="foo1" style="width:100%;" data-theme="a" class="header_a">
				<div data-role="navbar" class="ui-navbar" >
					<ul class="ui-grid-b" >
						<li class="ui-block-a" style="width:20%;">
							<a href="#" data-icon="info" data-iconpos="top">info</a>
						</li>
						<li class="ui-block-b" style="width:60%;">
							<a href="#"><img class="logo" src="logo.png"/></a>
						</li>
						<li class="ui-block-c" style="width:20%;">
							<a href="#" id="mgogo" data-icon="arrow-r" data-iconpos="top">Next</a>
						</li>
					</ul>
				</div>
			</div>
			<div data-role="content" data-theme="a" style="padding:4px 5px 5px;">
				<h4 style="margin: 6px 0 4px;text-align:center;">CHECK ONE OR MORE GENRES</h4>
				<form data-role="none" class="secimler">
					<div data-role="field-contain" class="ogedizilim ui-grid-a" data-mini="true">
						<fieldset data-role="controlgroup" data-type="vertical" class="ui-block-a" style="margin-right:-1px;"> 
							<input id="checkbox1" value="Action" name="genre" type="checkbox" />
							<label for="checkbox1">Action</label>
							<input id="checkbox2" value="Adventure" name="genre" type="checkbox" />
							<label for="checkbox2">Adventure</label>
							<input id="checkbox3" value="Animation" name="genre" type="checkbox" />
							<label for="checkbox3">Animation</label>
							<input id="checkbox4" value="Biography" name="genre" type="checkbox" />
							<label for="checkbox4">Biography</label>
							<input id="checkbox5" value="Comedy" name="genre" type="checkbox" />
							<label for="checkbox5">Comedy</label>
							<input id="checkbox6" value="Crime" name="genre" type="checkbox" />
							<label for="checkbox6">Crime</label>
							<input id="checkbox7" value="Docu" name="genre" type="checkbox" />
							<label for="checkbox7">Docu</label>
							<input id="checkbox8" value="Drama" name="genre" type="checkbox" style="background:#ff0000;" />
							<label for="checkbox8">Drama</label>
							<input id="checkbox9" value="Family" name="genre" type="checkbox" />
							<label for="checkbox9">Family</label>
							<input id="checkbox10" value="Fantasy" name="genre" type="checkbox" />
							<label for="checkbox10">Fantasy</label>
							<input id="checkbox11" value="Film-Noir" name="genre" type="checkbox" />
							<label for="checkbox11">Film-Noir</label>
						</fieldset>
						<fieldset data-role="controlgroup" data-type="vertical" data-role="fieldcontain" class="ui-block-b"> 
							<input id="checkbox12" value="History" name="genre" type="checkbox" />
							<label for="checkbox12">History</label>
							<input id="checkbox13" value="Horror" name="genre" type="checkbox" />
							<label for="checkbox13">Horror</label>
							<input id="checkbox14" value="Music" name="genre" type="checkbox" />
							<label for="checkbox14">Music</label>
							<input id="checkbox15" value="Musical" name="genre" type="checkbox" />
							<label for="checkbox15">Musical</label>
							<input id="checkbox16" value="Mystery" name="genre" type="checkbox" />
							<label for="checkbox16">Mystery</label>
							<input id="checkbox17" value="Romance" name="genre" type="checkbox" />
							<label for="checkbox17">Romance</label>
							<input id="checkbox18" value="Sci-Fi" name="genre" type="checkbox"/>
							<label for="checkbox18">Sci-Fi</label>
							<input id="checkbox19" value="Sport" name="genre" type="checkbox"/>
							<label for="checkbox19">Sport</label>
							<input id="checkbox20" value="Thriller" name="genre" type="checkbox"/>
							<label for="checkbox20">Thriller</label>
							<input id="checkbox21" value="War" name="genre" type="checkbox"/>
							<label for="checkbox21">War</label>
							<input id="checkbox22" value="Western" name="genre" type="checkbox"/>
							<label for="checkbox22">Western</label>									
						</fieldset>
					</div>
				</form><!--Genre secim formu -->
			</div>
			<!-- //Footer Navbar Askýda 24.02.2013//
			<div data-role="footer" data-id="foo1" data-theme="a" data-position="fixed" class="nav-glyphish-example">				
				<div data-role="navbar" class="nav-glyphish-example" data-grid="c">
					<ul>
						<li><a href="#page1" id="mgenre2" data-role="button" data-icon="custom" class="ui-btn-up-f ui-btn-active ui-state-persist">Genre</a></li>
						<li><a href="#page2" id="mtime" data-role="button" data-icon="custom" data-transition="slide">Year</a></li>
						<li><a href="#page3" id="mrating" data-role="button" data-icon="custom" data-transition="slide">Rating</a></li>
						<li><a href="#" id="mgogo" data-role="button" data-icon="custom" data-transition="slide">Go Go</a></li>
					</ul>
				</div>
			</div>
			-->
        </div>
		
		<div data-role="page" id="page2"><!--Page 2 -KEYWORD SEÇÝM SAYFASI // HAZIRLANIYOR // yavuz uydurma-->
            
		</div> <!--End of page 2 -->

		<div data-role="page" id="page3"> <!--Page 3 - Watch list sayfasi -->
            <div data-role="header" data-position="fixed" data-id="foo1" style="width:100%;" data-theme="a">
				<div data-role="navbar" class="ui-navbar">
					<ul class="ui-grid-b">
						<li class="ui-block-a" style="width:20%;">
							<a href="#page2" data-icon="arrow-l" data-iconpos="top" >Back</a>
						</li>
						<li class="ui-block-b" style="width:60%;">
							<a href="#"><img class="logo" src="logo.png"/></a>
						</li>
						<li class="ui-block-c" style="width:20%;">
							<a href="#"data-icon="arrow-r" data-iconpos="top">Next</a>
						</li>
					</ul>
				</div>
			</div>
			<div data-role="content">
					<h1>My Watch List</h1>	  					
  					<ul data-role="listview" data-split-icon="gear" data-split-theme="d" data-inset="true" class="movie_wish_list">
						    <!-- watch list itemlari burayi populate edecek -->
					</ul>
						<div data-role="popup" id="delete" data-theme="d" data-overlay-theme="b" class="ui-content" style="max-width:340px; padding-bottom:2em;"> <!-- delete movie from watchlist -->
						    <h3>Delete Movie?</h3>
						    <p>The movie will be deleted from your Watch List</p>
						    <a onclick="removeMyMovie(); getMyAllMovies(); location.reload();" href="javascript:void(0);" data-role="button" data-rel="back" data-theme="b" data-icon="check" data-inline="true" data-mini="true">Confirm</a>
						    <a href="index.html" data-role="button" data-rel="back" data-inline="true" data-mini="true">Cancel</a>
						</div>

  					<script type="text/javascript">//console.log ("lol");</script> <!-- for debugging purposes --> 
  					

  					<div><a onclick="clearLocal(); getMyAllMovies(); location.reload();" href="javascript:void(0);">Clear My List</a></div>	
				<script>
  					// getMyAllMovies();
				</script>
			</div><!-- /content -->
			<div data-role="footer" data-id="foo1" data-theme="a" data-position="fixed" class="nav-glyphish-example">				
			</div>
		</div><!--End of page 3 -->
		

		<div data-role="page" id="result0"><!--Sonuc sayfasi 0-->
            <div data-role="panel" id="mypanel" data-display="overlay">
    			<a href = "#page3"> My Watch List</a>
  			</div><!-- /panel -->
            <div data-role="header" data-position="fixed" data-id="foo1" style="width:100%;" data-theme="a">
				<div data-role="navbar" class="ui-navbar" >
					<ul class="ui-grid-b" >
						<li class="ui-block-a" style="width:20%;">
							<a href="#mypanel" data-icon="bars" data-iconpos="top" >Menu</a>
						</li>
						<li class="ui-block-b" style="width:60%;">
							<a href="#"><img class="logo" src="logo.png"/></a>
						</li>
						<li class="ui-block-c" style="width:20%;">
							<a href="#result1" data-icon="arrow-r" data-iconpos="top">2nd</a>
						</li>
					</ul>
				</div>
			</div>
			<div data-role="content" class="content_sonuc">    
				<div id="result0_arka" class="arka">
					<div class="blackbg"></div>
				</div>
				<div class="content_sonuc_inner">
					<div id="result0_title" class="titlem"> </div>
					<div class="result0_poster poster"> </div>
					<div id="result0_rating" class="rating"></div>
					<div class="addwatch">
						<div id="addToWatchList1" data-role="button" data-icon="star">Add</div>
						<div class = "hidden" style ="display:none; color:white;"> Added to watchlist </div>
					</div>
					<div id="result0_plot" class="plotm"> </div>
				</div>
						

			</div><!-- /content -->
		</div>

		<div data-role="page" id="result1"><!--Sonuc sayfasi 1-->
            <div data-role="panel" id="mypanel" data-display="overlay">
    			<a href = "#page3"> My Watch List</a>
  			</div><!-- /panel -->
            <div data-role="header" data-position="fixed" data-id="foo1" style="width:100%;" data-theme="a">
				<div data-role="navbar" class="ui-navbar" >
					<ul class="ui-grid-b" >
						<li class="ui-block-a" style="width:20%;">
							<a href="#mypanel" data-icon="grid" data-iconpos="top" >Menu</a>
						</li>
						<li class="ui-block-b" style="width:60%;">
							<a href="#"><img class="logo" src="logo.png"/></a>
						</li>
						<li class="ui-block-c" style="width:20%;">
							<a href="#result2" data-icon="arrow-r" data-iconpos="top">3rd</a>
						</li>
					</ul>
				</div>
			</div>
			<div data-role="content" class="content_sonuc">    
				<div id="result1_arka" class="arka">
					<div class="blackbg"></div>
				</div>
				<div class="content_sonuc_inner">
					<div id="result1_title" class="titlem"> </div>
					<div class="result1_poster poster"> </div>
					<div id="result1_rating" class="rating"></div>
					<div class="addwatch">
						<div id="addToWatchList2" data-role="button" data-icon="star">Add</div>
						<div class = "hidden" style ="display:none; color:white;"> Added to watchlist </div>
					</div>
					<div id="result1_plot" class="plotm"> </div>
				</div>

						
			</div><!-- /content -->
		</div> <!--end of sonuc sayfasi --> <!--end of sonuc sayfasi -->

		<div data-role="page" id="result2"><!--Sonuc sayfasi 2-->
            <div data-role="panel" id="mypanel" data-display="overlay">
    			<a href = "#page3"> My Watch List</a>
  			</div><!-- /panel -->	
            <div data-role="header" data-position="fixed" data-id="foo1" style="width:100%;" data-theme="a">
				<div data-role="navbar" class="ui-navbar" >
					<ul class="ui-grid-b" >
						<li class="ui-block-a" style="width:20%;">
							<a href="#mypanel" data-icon="grid" data-iconpos="top" >Menu</a>
						</li>
						<li class="ui-block-b" style="width:60%;">
							<a href="#"><img class="logo" src="logo.png"/></a>
						</li>
						<li class="ui-block-c" style="width:20%;">
							<a href="#result3" data-icon="arrow-r" data-iconpos="top">4th</a>
						</li>
					</ul>
				</div>
			</div>
			<div data-role="content" class="content_sonuc">    
				<div id="result2_arka" class="arka">
					<div class="blackbg"></div>
				</div>
				<div class="content_sonuc_inner">
					<div id="result2_title" class="titlem"> </div>
					<div class="result2_poster poster"> </div>
					<div id="result2_rating" class="rating"></div>
					<div class="addwatch">
						<div id="addToWatchList3" data-role="button" data-icon="star">Add</div>
					</div>
					<div id="result2_plot" class="plotm"> </div>
				</div>

						
			</div><!-- /content -->
		</div> <!--end of sonuc sayfasi --> <!--end of sonuc sayfasi -->

		<div data-role="page" id="result3"><!--Sonuc sayfasi 3-->
            <div data-role="panel" id="mypanel" data-display="overlay">
    			<a href = "#page3"> My Watch List</a>
  			</div><!-- /panel -->	
            <div data-role="header" data-position="fixed" data-id="foo1" style="width:100%;" data-theme="a">
				<div data-role="navbar" class="ui-navbar" >
					<ul class="ui-grid-b" >
						<li class="ui-block-a" style="width:20%;">
							<a href="#" data-icon="grid" data-iconpos="top" >Menu</a>
						</li>
						<li class="ui-block-b" style="width:60%;">
							<a href="#mypanel"><img class="logo" src="logo.png"/></a>
						</li>
						<li class="ui-block-c" style="width:20%;">
							<a href="#result4" data-icon="arrow-r" data-iconpos="top">5th</a>
						</li>
					</ul>
				</div>
			</div>
			<div data-role="content" class="content_sonuc">    
				<div id="result3_arka" class="arka">
					<div class="blackbg"></div>
				</div>
				<div class="content_sonuc_inner">
					<div id="result3_title" class="titlem"> </div>
					<div class="result3_poster poster"> </div>
					<div id="result3_rating" class="rating"></div>
					<div class="addwatch">
						<div id="addToWatchList4" data-role="button" data-icon="star">Add</div>
					</div>
					<div id="result3_plot" class="plotm"> </div>
				</div>

						
			</div><!-- /content -->
		</div> <!--end of sonuc sayfasi --> <!--end of sonuc sayfasi -->

		<div data-role="page" id="result4"><!--Sonuc sayfasi 4-->
            <div data-role="panel" id="mypanel" data-display="overlay">
    			<a href = "#page3"> My Watch List</a>
  			</div><!-- /panel -->	
            <div data-role="header" data-position="fixed" data-id="foo1" style="width:100%;" data-theme="a">
				<div data-role="navbar" class="ui-navbar" >
					<ul class="ui-grid-b" >
						<li class="ui-block-a" style="width:20%;">
							<a href="#mypanel" data-icon="grid" data-iconpos="top" >Menu</a>
						</li>
						<li class="ui-block-b" style="width:60%;">
							<a href="#"><img class="logo" src="logo.png"/></a>
						</li>
						<li class="ui-block-c" style="width:20%;">
							<a href="#result0" data-icon="arrow-r" data-iconpos="top">1st</a>
						</li>
					</ul>
				</div>
			</div>
			<div data-role="content" class="content_sonuc">    
				<div id="result4_arka" class="arka">
					<div class="blackbg"></div>
				</div>
				<div class="content_sonuc_inner">
					<div id="result4_title" class="titlem"> </div>
					<div class="result4_poster poster"> </div>
					<div id="result4_rating" class="rating"></div>
					<div class="addwatch">
						<div id="addToWatchList5" data-role="button" data-icon="star">Add</div>
					</div>
					<div id="result4_plot" class="plotm"> </div>
				</div>
			</div><!-- /content -->
		</div> <!--end of sonuc sayfasi --> <!--end of sonuc sayfasi -->

		<script>
			$("#addToWatchList1").click(function( event ) {
	  				storeMyMovie(document.getElementById('result0_title'));
	  				getMyMovie();
	  				$("div.hidden").fadeIn( 500 );
	  				$("div.hidden").fadeOut( 1000 );
				});
		
				$("#addToWatchList2").click(function( event ) {
					storeMyMovie(document.getElementById('result1_title'));
					getMyMovie();
					$("div.hidden").fadeIn( 500 );
	  				$("div.hidden").fadeOut( 1000 );				
				});
			
				$("#addToWatchList3").click(function( event ) {
					storeMyMovie(document.getElementById('result2_title'));
					getMyMovie();
					$("div.hidden").fadeIn( 500 );
  					$("div.hidden").fadeOut( 1000 );		
				});
			
				$("#addToWatchList4").click(function( event ) {
					storeMyMovie(document.getElementById('result3_title'));
					getMyMovie();
					$("div.hidden").fadeIn( 500 );
  					$("div.hidden").fadeOut( 1000 );	
				});
			
				$("#addToWatchList5").click(function( event ) {
					storeMyMovie(document.getElementById('result4_title'));
					getMyMovie();
					$("div.hidden").fadeIn( 500 );
	  				$("div.hidden").fadeOut( 1000 );	
				});

			getMyAllMovies();
			console.log(localStorage.length);//debug
			console.log(i);//debug				
		</script>
    </body>
</html>

