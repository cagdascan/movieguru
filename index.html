<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
			<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"> 
			<meta name="apple-mobile-web-app-capable" content="yes" />
			<meta name="apple-mobile-web-app-status-bar-style" content="black" />
			<title>Movie Guru</title>
			<link rel="stylesheet" href="assets/jquery.mobile-1.3.0.min.css" />
			<link rel="stylesheet" href="assets/mg.css" />
			<link rel="stylesheet" href="assets/sonuc.css" />
			<link rel="stylesheet" href="assets/rs-default-inverted.css" />
			<script src="assets/jquery-1.8.2.min.js"></script>
			<script src="assets/jquery.mobile-1.3.0.min.js"></script>
			<script src="cordova-2.5.0.js"></script>
			<script src="js/sonuc.js"></script>
			<script src="https://apis.google.com/js/plusone.js" type="text/javascript"></script>
			<script type="text/javascript" charset="utf-8">
			var email = '';
			var network;
			//var ttids = [];
			var resulthtml =  '';
			var slider;
			function checkConnection() {
				var networkState = navigator.connection.type;
				var states = {};
				states[Connection.UNKNOWN]  = 'Unknown connection';
				states[Connection.ETHERNET] = 'Ethernet connection';
				states[Connection.WIFI]     = 'WiFi connection';
				states[Connection.CELL_2G]  = 'Cell 2G connection';
				states[Connection.CELL_3G]  = 'Cell 3G connection';
				states[Connection.CELL_4G]  = 'Cell 4G connection';
				states[Connection.NONE]     = 'No network connection';
				network = states[networkState];
				}
			$(function() { 
				document.addEventListener("deviceready", onDeviceReady, false);
				$.mobile.defaultHomeScroll = 0;
			});

		
			function onDeviceReady() {
				// Register the event listener
				//var ref = window.open('http://apache.org', '_blank', 'location=yes');
				//ref.addEventListener('loadstart', function() { alert('start: ' + event.url); });
				//ref.addEventListener('loadstop', function() { alert('stop: ' + event.url); });
				//ref.addEventListener('exit', function() { alert(event.type); });
				cordova.exec(null, null, "SplashScreen", "hide", []);
				document.addEventListener("backbutton", function(e){ //back button functionality (for android)
					if($.mobile.activePage.is('#page1')){
						var answer = confirm("Are you sure you want to exit?")
							if (answer){
								e.preventDefault();
								navigator.app.exitApp();
							}
					}
					else {
						if($.mobile.activePage.is('#pagekw')){
							resetapp();
						}
						history.back();
					}
				}, false); //end of back button
				
				document.addEventListener("menubutton", function(e){ //menu button functionality (for android)
						$('.menuac').trigger('click');	
					}, false);
				}

			$('#mgogo1').live('click',function() //next button pressed on genres screen
			{
				checkConnection();
				if(network=='No network connection')
				{
					$('#popupopen3').trigger('click');
				}
				else
				{
					var secimkontrol = $('input[name=\'genre\']:checked').val();
					if(secimkontrol!=undefined){
						var secilenler = $('.secimler1').serialize().toString();
						console.log(secilenler);//for debugging
						$.mobile.showPageLoadingMsg("b", "Loading", false); //loading spinner
						$.getJSON("http://bayez.biz/moviegurus/?query=20&" + $('.secimler1').serialize(),
							function (data)
							{
								var keywords = [];
								var result_keyword = function(i){
									return "#result"+i+"_keyword";
								};
								var y = 0;
								$.each(data, function(i,item)
								{
									if(y<20){
										keywords.push(item._id);
										$('#containkw').append ('<input class="ui-body-a" id="result_'+i+'_keyword" value="'+keywords[i]+'" name="keyword" type="checkbox" /><label for="result_'+i+'_keyword" style="">'+keywords[i]+'</label>');
									}
									y++;
								});
								$('#containkw').trigger('create');
								$.mobile.changePage('#pagekw');
							});
						$.post("http://bayez.biz/moviegurus/?query=10&userid=" + email);
					}
					else {
						$('#popupopen').trigger('click');
					}
				}
			});
			$('#mgogo2').live('click',function() //next button pressed on keyword screen
			{
				checkConnection();
				if(network=='No network connection')
				{
					alert('Please check your network connection');
				}
				else
				{
					var secimkontrol2 = $('input[name=\'keyword\']:checked').val();
					if(secimkontrol2!=undefined){
						var secilenler = $('.secimler1').serialize().toString();
						console.log(secilenler);//for debugging
						$.mobile.showPageLoadingMsg("b", "Loading", false); //loading spinner
						$.getJSON("http://bayez.biz/moviegurus/?query=30&" + $('.secimler1').serialize(),
							function (data)
							{
								resulthtml = '';
								var titles = [];
								var ratings = [];
								var posters = [];
								var directors = [];
								var actors = [];
								var plots = [];
								var result_title = function(i){
									return "#result"+i+"_title";
								};
								var result_rating = function(i){
									return "#result"+i+"_rating";
								};
								var result_poster = function(i){
									return "#result"+i+"_poster";
								};
								var result_director = function(i){
									return "#result"+i+"_director";
								};
								var result_actor = function(i){
									return "#result"+i+"_actor";
								};
								var result_plot = function(i){
									return "#result"+i+"_plot";
								};
								var result_ttid = function(i){
									return "#result"+i+"_ttid";
								};
								$.each(data, function(i,item)
								{	
								//$('.result').clone().attr('id','result'+i).appendTo('body');
									var orderm = i + 1;
									//titles.push('<span>' + orderm + '</span>' + item.name);
									//ratings.push('<p>' + item.userRating + '</p>' );
									//posters.push("<img style='display:block;width:100%;height:auto;' src='" + item.pLink + "' />");
									var dirdif = item.director.toString();
									dirdif = dirdif.replace(/,/g,"<br />");
									//directors.push("<div class='directors'>" + dirdif + "</div>");
									var actidif = item.actors.toString();
									actidif = actidif.replace(/,/g,"<br />");
									//actors.push("<div class='cast'>" + actidif + "</div>");
									//plots.push(item.plotS);
									//ttids.push(item.ttid);
									/*$(result_title(i)).append (titles[i]);
									$(result_rating(i)).append (ratings[i]);
									$(result_poster(i)).append (posters[i]);
									$(result_director(i)).append (directors[i]);
									$(result_actor(i)).append (actors[i]);
									$(result_plot(i)).append (plots[i]);*/
									
									resulthtml = '<div data-role="content" class="content_sonuc">'+
											 '<div id="result0_title" class="titlem">'+ item.name +'</div>'+
											 '<div id="result0_poster" class="poster"><img style="display:block;width:100%;height:auto;" src="' + item.pLink + '" /></div>'+
											 '<div id="result0_rating" class="rating">'+ item.userRating +'</div>'+
											 '<div id="result0_director"><div class="directors">'+ dirdif +'</div></div>'+
											 '<div id="result0_actor"><div class="cast">'+ actidif +'</div></div>'+
											 '<div class="addwatch">'+
											 '	<div> <a style="margin-left:0;" class="addToWatchList" href="#popupInfo" data-rel="popup" data-role="button" data-inline="true" data-transition="flow" data-icon="star" data-mini="true" data-theme="e" data-film="'+ item.ttid +'">Watch later</a></div>'+
											 '</div>'+
											 '<div class="addseen">'+
											 '	<div> <a style="margin-left:0;" class="addToAlreadySeenList" href="#popupInfos" data-rel="popup" data-role="button" data-inline="true" data-transition="flow" data-icon="star" data-mini="true" data-theme="a" data-film="'+ item.ttid +'">I saw this</a></div>'+
											 '</div>'+
											 '<div id="result0_plot" class="plotm">'+ item.plotS +'</div>'+
										 	 '</div>';
									$('#resultArea').append(resulthtml);
											 
								});
								$('#resultArea').trigger('create');
								
								var genislik = $('#result').width();
								var uzunluk = $('#result').height();
								
								$('#resultArea').width(genislik);
								$('#resultArea').height(uzunluk);
								
								slider = $('#resultArea').royalSlider({
												autoHeight: true,
												arrowsNav: false,
												fadeinLoadedSlide: false,
												controlNavigation: 'none',
												imageScaleMode: 'fit',
												imageAlignCenter: true,
												loop: false,
												loopRewind: true,
												keyboardNavEnabled: true,
												navigateByClick: false,
												autoScaleSlider: false
											  }).data('royalSlider');
											  $('#rsonraki').click(function() {
												slider.next();
											  });
											  $('#slider-prev').click(function() {
												slider.prev();
											  });
											  $('.home_reset').click(function() {
												slider.destroy();
												console.log('Destroy');
											  });
											  
							  $.mobile.changePage('#result');
							  

							});
					}
					else {
						$('#popupopen2').trigger('click');
					}
				}
			});
		</script>
		</head>
		<body>
			<div data-role = "page" id = "login_page"> <!--Login page -->
				<span id="signinButton">
					<span
						class="g-signin"
						data-callback="signinCallback"
						data-clientid=248012238476.apps.googleusercontent.com
						data-cookiepolicy="none"
						data-requestvisibleactions="http://schemas.google.com/AddActivity"
						data-scope="https://www.googleapis.com/auth/plus.login https://www.googleapis.com/auth/userinfo.email">
					</span>
				</span>
			</div>

			<div data-role="page" id="page1"> <!--Page 1 - Genre secim sayfasi -->
				<a href="#mypanel" class="menuac" style="display:none;">Menu</a>
					<div data-role="panel" data-position-fixed="true" id="mypanel" data-divider-theme="d" data-theme="c">
						<ul data-role="listview" data-theme="c">
							<li data-role="list-divider">Main Menu</li>
							<li data-icon="home" data-iconpos="left" id="skull"><a href="#page1" class="home_reset">Home</a></li>
							<li data-icon="info"><a href="#pageinfo" data-transition="flip">Info</a></li>
							<li data-icon="gear"><a href="#page3" onclick="getWatchlist();">Watchlist</a></li>
							<li data-icon="gear"><a href="#page4" onclick="getWatchedlist();">Watchedlist</a></li>
						</ul>
					</div><!-- /panel -->
				<div data-role="header" class="mgheader" data-position="fixed" data-id="persist" class="mgheader">
					<a href="#mypanel" data-icon="bars" data-iconpos="notext">Menu</a>
					<h1></h1>
					<a id="mgogo1" data-icon="arrow-r" data-icon="check" data-iconpos="notext" data-role="button" >Next</a>
					<a href="#positionWindow" id="popupopen" data-role="button" data-inline="true" data-rel="popup" data-position-to="window" style="display:none;">Popup</a>
					<a href="#positionWindow3" id="popupopen3" data-role="button" data-inline="true" data-rel="popup" data-position-to="window" style="display:none;">Popup</a>
					<div data-role="popup" id="positionWindow" class="ui-content" data-theme="b" data-overlay-theme="a">
						<p>Please select one or more <b>genres</b></p>
					</div>
					<div data-role="popup" id="positionWindow3" class="ui-content" data-theme="b" data-overlay-theme="a">
						<p style="padding:20px;text-align:center;">Please check your <strong>internet</strong> connection</p>
					</div>
				</div><!--end of header-->
				<div data-role="content" data-theme="a">
				<h2>Select genre(s) and go next</h2>
						<div id="email" class="hide"></div>
				<form data-role="none" class="secimler1">
					<div data-role="field-contain" class="ogedizilim" >
						<fieldset data-role="controlgroup" data-type="horizontal" data-mini="true">
							<input id="checkbox1" value="Action" name="genre" type="checkbox" />
							<label for="checkbox1" data-role="button" data-icon="custom" data-iconpos="top" class="icon-action" data-wrapperels="span">Action</label>
							<input id="checkbox2" value="Adventure" name="genre" type="checkbox" />
							<label for="checkbox2" data-icon="custom" data-iconpos="top" class="icon-adventure" data-wrapperels="span">Adventure</label>
							<input id="checkbox3" value="Animation" name="genre" type="checkbox" />
							<label for="checkbox3" data-role="button" data-icon="custom" data-iconpos="top" class="icon-animation" data-wrapperels="span">Animation</label>
							<input id="checkbox4" value="Biography" name="genre" type="checkbox" />
							<label for="checkbox4" data-role="button" data-icon="custom" data-iconpos="top" class="icon-biography" data-wrapperels="span">Biography</label>
							<input id="checkbox5" value="Comedy" name="genre" type="checkbox" />
							<label for="checkbox5" data-icon="custom" data-iconpos="top" class="icon-comedy" data-wrapperels="span">Comedy</label>
							<input id="checkbox6" value="Crime" name="genre" type="checkbox" />
							<label for="checkbox6" data-icon="custom" data-iconpos="top" class="icon-crime" data-wrapperels="span">Crime</label>
							<input id="checkbox7" value="Documentary" name="genre" type="checkbox" />
							<label for="checkbox7"  data-icon="custom" data-iconpos="top" class="icon-docu" data-wrapperels="span">Docu</label>
							<input id="checkbox8" value="Drama" name="genre" type="checkbox" style="background:#ff0000;" />
							<label for="checkbox8" data-icon="custom" data-iconpos="top" class="icon-drama" data-wrapperels="span">Drama</label>
							<input id="checkbox9" value="Family" name="genre" type="checkbox" />
							<label for="checkbox9" data-icon="custom" data-iconpos="top" class="icon-family" data-wrapperels="span">Family</label>
							<input id="checkbox10" value="Fantasy" name="genre" type="checkbox" />
							<label for="checkbox10" data-icon="custom" data-iconpos="top" class="icon-fantasy" data-wrapperels="span">Fantasy</label>
							<input id="checkbox11" value="Film-Noir" name="genre" type="checkbox" />
							<label for="checkbox11" data-icon="custom" data-iconpos="top" class="icon-film-noir" data-wrapperels="span">Film-Noir</label>
							<input id="checkbox12" value="History" name="genre" type="checkbox" />
							<label for="checkbox12" data-icon="custom" data-iconpos="top" class="icon-history" data-wrapperels="span">History</label>
							<input id="checkbox13" value="Horror" name="genre" type="checkbox" />
							<label for="checkbox13" data-icon="custom" data-iconpos="top" class="icon-horror">Horror</label>
							<input id="checkbox14" value="Music" name="genre" type="checkbox" />
							<label for="checkbox14" data-icon="custom" data-iconpos="top" class="icon-music">Music</label>
							<input id="checkbox15" value="Musical" name="genre" type="checkbox" />
							<label for="checkbox15" data-icon="custom" data-iconpos="top" class="icon-musical">Musical</label>
							<input id="checkbox16" value="Mystery" name="genre" type="checkbox" />
							<label for="checkbox16" data-icon="custom" data-iconpos="top" class="icon-mystery">Mystery</label>
							<input id="checkbox17" value="Romance" name="genre" type="checkbox" />
							<label for="checkbox17" data-icon="custom" data-iconpos="top" class="icon-romance">Romance</label>
							<input id="checkbox18" value="Sci-Fi" name="genre" type="checkbox"/>
							<label for="checkbox18" data-icon="custom" data-iconpos="top" class="icon-sci-fi">Sci-Fi</label>
							<input id="checkbox19" value="Sport" name="genre" type="checkbox"/>
							<label for="checkbox19" data-icon="custom" data-iconpos="top" class="icon-sport">Sport</label>
							<input id="checkbox20" value="Thriller" name="genre" type="checkbox"/>
							<label for="checkbox20" data-icon="custom" data-iconpos="top" class="icon-thriller">Thriller</label>
							<input id="checkbox21" value="War" name="genre" type="checkbox"/>
							<label for="checkbox21" data-icon="custom" data-iconpos="top" class="icon-war">War</label>
							<input id="checkbox22" value="Western" name="genre" type="checkbox"/>
							<label for="checkbox22" data-icon="custom" data-iconpos="top" class="icon-western">Western</label>
						</fieldset>
					</div>
				</form><!--Genre secim formu -->
				</div>
			</div>
			<div data-role="page" id="pageinfo"> <!--Info sayfasi -->
				<a href="#mypanel" class="menuac" style="display:none;">Menu</a>
				<div data-role="panel" data-position-fixed="true" id="mypanel" data-divider-theme="d" data-theme="c">
						<ul data-role="listview" data-theme="c">
							<li data-role="list-divider">Main Menu</li>
							<li data-icon="home" data-iconpos="left" id="skull"><a href="#page1" class="home_reset">Home</a></li>
							<li data-icon="info"><a href="#pageinfo" data-transition="flip">Info</a></li>
							<li data-icon="gear"><a href="#page3" onclick="getWatchlist();">Watchlist</a></li>
							<li data-icon="gear"><a href="#page4" onclick="getWatchedlist();">Watchedlist</a></li>
						</ul>
					</div><!-- /panel -->
				<div data-role="header" class="mgheader" data-position="fixed" data-id="persist">
					<a href="#mypanel" data-icon="bars">Menu</a>
					<h1></h1>
					<a href="#page1" data-icon="home" data-iconpos="notext" class="home_reset">Home</a>
				</div>
				<div data-role="content" data-theme="a">
				<div data-role="collapsible-set" data-theme="a" data-content-theme="d">
					<div data-role="collapsible">
						<h2>What is Movie Guru?</h2>
						<p>Movie Guru is a smart advisor for your movie pleasure.</p>
					</div>
					<div data-role="collapsible">
						<h2>Why is Movie Guru?</h2>
						<ul data-role="listview" data-theme="d" data-divider-theme="d" class="ince">
							<li>Make fast and accurate decisions with Movie Guru.</li>
							<li>Spend your time by watching movies, not by brooding to decide "which one?".</li>
							<li>Find the right movie according to your current preferences.</li>
						</ul>
					</div>
					<div data-role="collapsible">
						<h2>How to use?</h2>
							<ul data-role="listview" data-theme="d" data-divider-theme="d" class="ince">
								<li>First, choose one or more <b>genres</b> and go next.</li>
								<li>After choosing genre(s), Movie Guru will bring you a screen of keywords.</li>
								<li>Choose <b>keyword(s)</b> according to your mood</li>
								<li>That's it. Now, you see the the most suitable results for your movie pleasure.</li>
								<li>You may also use your <b>watchlist</b> by adding some movies in it.</li>
							</ul>
						</div>
					</div>
				</div>
			</div>
			<div data-role="page" id="pagekw" data-theme="a"><!--Keyword page -->
				<div data-role="header" class="mgheader" data-position="fixed" data-id="persist">
					<a href="#page1" class="home_reset" data-icon="arrow-l" data-iconpos="notext">Back</a>
					<h1></h1>
					<a id="mgogo2" data-icon="arrow-r" data-icon="check" data-iconpos="notext">Next</a>
					<a href="#positionWindow2" id="popupopen2" data-role="button" data-inline="true" data-rel="popup" data-position-to="window" style="display:none;">Popup</a>
					<div data-role="popup" id="positionWindow2" class="ui-content" data-theme="b" data-overlay-theme="a">
						<p>Please select one or more <b>keywords</b></p>
					</div>
				</div>
				<div data-role="content" data-theme="a">
					<h2>Select keyword(s) and go next</h2>
						<form data-role="none" class="secimler1">
							<div data-role="field-contain" >
								<fieldset data-role="controlgroup" data-type="horizontal" data-theme="a">
									<div id="containkw" data-theme="a">
										<!-- keywordler burayi populate ediyor -->
									</div>
								</fieldset>
							</div>
						</form>
				</div>
				</div> <!--End of page 2 -->

			<div data-role="page" id="page3" data-theme="a"> <!--Page 3 - Watch list sayfasi -->
				<a href="#mypanel" class="menuac" style="display:none;">Menu</a>
				<div data-role="panel" data-position-fixed="true" id="mypanel" data-divider-theme="d" data-theme="c">
						<ul data-role="listview" data-theme="c">
							<li data-role="list-divider">Main Menu</li>
							<li data-icon="home" data-iconpos="left" id="skull"><a href="#page1" class="home_reset">Home</a></li>
							<li data-icon="info"><a href="#pageinfo" data-transition="flip">Info</a></li>
							<li data-icon="gear"><a href="#page3" onclick="getWatchlist();">Watchlist</a></li>
							<li data-icon="gear"><a href="#page4" onclick="getWatchedlist();">Watchedlist</a></li>
						</ul>
					</div><!-- /panel -->	
				<div data-role="header" class="mgheader" data-position="fixed" data-id="persist">
					<a href="#mypanel" data-icon="bars" data-iconpos="notext">Menu</a>
					<h1></h1>
					<a href="index.html" data-icon="home" data-iconpos="notext" class="home_reset">Home</a>
				</div>
				<div data-role="content">
						<h1>My Watch List</h1>
					<div class ="movie_wish_list">
						<ul id="movie_watch_list" data-role="listview" data-split-icon="gear" data-theme="e" data-inset="true">
							<!-- watch list itemlari burayi populate edecek -->
						</ul>
					</div>
					<div data-role="popup" id="delete" data-theme="d" data-overlay-theme="b" class="ui-content" style="max-width:340px; padding-bottom:2em;"> <!-- delete movie from watchlist -->
						<h3>Delete Movie?</h3>
						<p>The movie will be deleted from your Watch List</p>
						<a onclick="removeMyMovie();" href="#page3" data-role="button" data-rel="back" data-theme="b" data-icon="check" data-inline="true" data-mini="true">Confirm</a>
						<a href="index.html" data-role="button" data-rel="back" data-inline="true" data-mini="true">Cancel</a>
					</div>
					<div><a onclick="clearWatchlist();" href="javascript:void(0);">Clear My List</a></div>
				</div><!-- /content -->
			</div><!--End of page 3 -->
			<div data-role="page" id="page4" data-theme="a"> <!--Page 4 - Watched list sayfasi -->
				<a href="#mypanel" class="menuac" style="display:none;">Menu</a>
				<div data-role="panel" data-position-fixed="true" id="mypanel" data-divider-theme="d" data-theme="c">
						<ul data-role="listview" data-theme="c">
							<li data-role="list-divider">Main Menu</li>
							<li data-icon="home" data-iconpos="left" id="skull"><a href="#page1" class="home_reset">Home</a></li>
							<li data-icon="info"><a href="#pageinfo" data-transition="flip">Info</a></li>
							<li data-icon="gear"><a href="#page3" onclick="getWatchlist();">Watchlist</a></li>
							<li data-icon="gear"><a href="#page4" onclick="getWatchedlist();">Watchedlist</a></li>
						</ul>
					</div><!-- /panel -->	
				<div data-role="header" class="mgheader" data-position="fixed" data-id="persist">
					<a href="#mypanel" data-icon="bars" data-iconpos="notext">Menu</a>
					<h1></h1>
					<a href="index.html" data-icon="home" data-iconpos="notext" class="home_reset">Home</a>
				</div>
				<div data-role="content">
						<h1>My Watched List</h1>
					<div class ="movie_wish_list">
						<ul id="movie_watched_list" data-role="listview" data-inset="true" data-split-icon="gear" data-split-theme="d">
							<!-- watched list itemlari burayi populate edecek -->
						</ul>
					</div>
					<div data-role="popup" id="delete" data-theme="d" data-overlay-theme="b" class="ui-content" style="max-width:340px; padding-bottom:2em;"> <!-- delete movie from watchlist -->
						<h3>Delete Movie?</h3>
						<p>The movie will be deleted from your Watch List</p>
						<a onclick="removeMyMovie();" href="#page3" data-role="button" data-rel="back" data-theme="b" data-icon="check" data-inline="true" data-mini="true">Confirm</a>
						<a href="index.html" data-role="button" data-rel="back" data-inline="true" data-mini="true">Cancel</a>
					</div>
					<div><a onclick="clearWatchedlist();" href="javascript:void(0);">Clear My List</a></div>
				</div><!-- /content -->
			</div><!--End of page 4 -->

			<div data-role="page" id="result" class="result"><!--Result page-->
         <a href="#mypanel" class="menuac" style="display:none;">Menu</a>
				<div data-role="header" class="mgheader" data-position="fixed" data-id="persist">
					<a href="#mypanel" data-icon="bars" data-iconpos="notext">Menu</a>
					<h1></h1>
					<a href="javascript:void(0)" data-transition="slide" data-icon="arrow-r" id="rsonraki" data-iconpos="notext">Next</a>
				</div>
				<div id="resultArea" class="royalSlider rsDefaultInv"></div>
          <div data-role="popup" id="popupInfo" data-theme="e" style="max-width:200px;">
          	<p>Added to your watch list</p>
              <a href="#" data-role="button" data-inline="true" data-rel="back" data-theme="c" id="cancels" style="display:none;">Cancel</a>
           </div>
          <div data-role="popup" id="popupInfos" data-theme="a" style="max-width:200px;">
          	<p>Added to your seen list</p>
              <a href="#" data-role="button" data-inline="true" data-rel="back" data-theme="c" id="cancelss" style="display:none;">Cancel</a>
          </div>
          <div data-role="panel" id="mypanel" data-display="overlay" data-divider-theme="d" data-theme="d">
						<ul data-role="listview" data-theme="c">
							<li data-role="list-divider">Main Menu</li>
							<li data-icon="home" data-iconpos="left" id="skull"><a href="#page1" class="home_reset">Home</a></li>
							<li data-icon="info"><a href="#pageinfo" data-transition="flip">Info</a></li>
							<li data-icon="gear"><a href="#page3" onclick="getWatchlist();">Watchlist</a></li>
							<li data-icon="gear"><a href="#page4" onclick="getWatchedlist();">Watchedlist</a></li>
						</ul>
					</div>
			</div>
		<script>
			$(".addToWatchList").live('click', function() {
					var filmID = $(this).data('film');
					var addToWatchList1= "http://bayez.biz/moviegurus/?query=41&userid=" + email + "&ttid=" + filmID;
					console.log(addToWatchList1);//need to send this string to server
					$.post(addToWatchList1);
					setTimeout(function(){
						$('#cancels').trigger('click');
					},1000);
				});
				
				$(".addToAlreadySeenList").live('click', function() {
					var filmID = $(this).data('film');
					var addToAlreadySeenList1= "http://bayez.biz/moviegurus/?query=51&userid=" + email + "&ttid=" + filmID;
					console.log(addToAlreadySeenList1);//need to send this string to server
					$.post(addToAlreadySeenList1);
					setTimeout(function(){
						$('#cancelss').trigger('click');
					},1000);
				});
				
				$(".home_reset").live('click', function() { //home butonuna basinca ilk sonuc kumesini sifirlama
					resetapp();
				});
				
				function resetapp(){
					$('#resultArea div').remove();
					$('#resultArea').removeAttr('class');
					$('#resultArea').removeAttr('style');
					
					$(".secimler1")[0].reset();
					$("#containkw").empty();
					//ttids=[];
					
					$('.ui-btn-hover-a').each(function(){
						$(this).trigger('mouseout');
					});
				}
				function getWatchlist(){
					$("#movie_watch_list").empty();
					$.getJSON("http://bayez.biz/moviegurus/?query=61&userid=" + email,
						function(data)
						{
							$.each(data, function(i,item)
								{
									$("#movie_watch_list").append('<li><img src="'+item.pLink+'" width="80px" height="80px">'+item.name+'</li>');
								}
						)});
				}

				function getWatchedlist(){
					$("#movie_watched_list").empty();
					$.getJSON("http://bayez.biz/moviegurus/?query=71&userid=" + email,
						function(data)
						{
							$.each(data, function(i,item)
								{
									$("#movie_watched_list").append('<li><img src="'+item.pLink+'" width="80px" height="80px">'+item.name+'</li>');
								}
						)});
				}

				function clearWatchlist(){
					$("#movie_watch_list").empty();
					$.post("http://bayez.biz/moviegurus/?query=82&userid=" + email);
				}

				function clearWatchedlist(){
					$("#movie_watched_list").empty();
					$.post("http://bayez.biz/moviegurus/?query=92&userid=" + email);
				}
	
		</script>
		<script type="text/javascript"> //google plus authorization stuff starts
      (function() {
       var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
       po.src = 'https://apis.google.com/js/client:plusone.js';
       var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
     	})();
	
			function signinCallback(authResult) {
				if (authResult['access_token']) {
					// Successfully authorized
					console.log("Auth success");
					getEmail();
					// Hide the sign-in button now that the user is authorized, for example:
					document.getElementById('signinButton').setAttribute('style', 'display: none');
					$.mobile.changePage('#page1');
				} else if (authResult['error']) {
				// There was an error.
				// Possible error codes:
				//   "access_denied" - User denied access to your app
				//   "immediate_failed" - Could not automatially log in the user
				// console.log('There was an error: ' + authResult['error']);
				}
			}

			function getEmail(){
    	// Load the oauth2 libraries to enable the userinfo methods.
				gapi.client.load('oauth2', 'v2', function() {
        	  var request = gapi.client.oauth2.userinfo.get();
          	request.execute(getEmailCallback);
        	});
			}

			function getEmailCallback(obj){
				var el = document.getElementById('email');
				if (obj['email']) {
					email = obj['email'];
				}

				console.log(obj);   // Uncomment to inspect the full object.

				el.innerHTML = email;
				toggleElement('email');
			}

			function toggleElement(id) {
				var el = document.getElementById(id);
				if (el.getAttribute('class') == 'hide') {
					el.setAttribute('class', 'show');
				} else {
					el.setAttribute('class', 'hide');
				}
			}
    </script><!--google plus authorization stuff ends -->
	</body>
</html>

